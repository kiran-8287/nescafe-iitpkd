/*! For license information please see 592.f819c1b9.js.LICENSE.txt */
"use strict";(self.webpackChunknescafe_restaurant=self.webpackChunknescafe_restaurant||[]).push([[592],{2592(e,a,r){r.r(a),r.d(a,{default:()=>k});var t=r(6540),s=r(8449),l=r(429),d=r(5164),n=r(892),c=r(7235),i=r(4207);const o=(0,i.A)("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);var x=r(7133),m=r(165),h=r(6644);const p=(0,i.A)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);(0,i.A)("CircleDashed",[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]]);var y=r(3436),u=r(8110),g=r(888),b=r(4848);const f={pending:{color:"bg-amber-100 text-amber-700",icon:c.A,label:"Pending"},preparing:{color:"bg-blue-100 text-blue-700",icon:o,label:"Preparing"},ready:{color:"bg-purple-100 text-purple-700",icon:x.A,label:"Ready"},delivered:{color:"bg-green-100 text-green-700",icon:m.A,label:"Delivered"},cancelled:{color:"bg-red-100 text-red-700",icon:h.A,label:"Cancelled"}},k=()=>{const{user:e}=(0,l.A)(),[a,r]=(0,t.useState)([]),[c,i]=(0,t.useState)(!0),[o,h]=(0,t.useState)("all");(0,t.useEffect)(()=>{k();const e=s.N.channel("orders-channel").on("postgres_changes",{event:"*",schema:"public",table:"orders"},()=>{k()}).subscribe();return()=>{s.N.removeChannel(e)}},[]);const k=async()=>{try{const{data:e,error:a}=await s.N.from("orders").select("\n                    *,\n                    users!orders_user_id_fkey (name, email),\n                    order_items (*)\n                ").order("created_at",{ascending:!1});if(a)throw a;r(e)}catch(e){console.error("Error fetching orders:",e),g.Ay.error("Failed to load orders")}finally{i(!1)}},j=async(e,a)=>{try{const{error:r}=await s.N.from("orders").update({status:a}).eq("id",e);if(r)throw r;g.Ay.success(`Order marked as ${a}`)}catch(e){console.error("Error updating status:",e),g.Ay.error("Failed to update status")}},w="all"===o?a:a.filter(e=>e.status===o);return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8 font-sans",children:[(0,b.jsxs)("header",{className:"max-w-6xl mx-auto mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-black text-[#3E2723]",children:"Nescafe Command Center"}),(0,b.jsx)("p",{className:"text-gray-500 font-medium",children:"Manage incoming orders and live status."})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("button",{onClick:async()=>{if(window.confirm("⚠️ DANGER: This will delete ALL user profiles, ALL orders, and ALL order items. You must still manually delete users from the Supabase Auth tab. Proceed?"))try{i(!0);const{error:e}=await s.N.from("order_items").delete().neq("id","00000000-0000-4000-a000-000000000000");if(e)throw e;const{error:a}=await s.N.from("orders").delete().neq("id","00000000-0000-4000-a000-000000000000");if(a)throw a;const{error:r}=await s.N.from("users").delete().neq("id","00000000-0000-4000-a000-000000000000");if(r)throw r;g.Ay.success("System Reset Complete!"),k()}catch(e){console.error("Reset error:",e),g.Ay.error("Failed to reset system")}finally{i(!1)}},className:"flex items-center gap-2 bg-red-50 text-red-600 px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wider hover:bg-red-100 transition-all border border-red-100",children:[(0,b.jsx)(p,{size:14})," System Reset"]}),(0,b.jsx)("div",{className:"flex bg-white p-1 rounded-2xl shadow-sm border border-gray-100 overflow-x-auto",children:["all","preparing","ready","delivered"].map(e=>(0,b.jsx)("button",{onClick:()=>h(e),className:"px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wider transition-all whitespace-nowrap "+(o===e?"bg-[#3E2723] text-white":"text-gray-400 hover:text-[#3E2723]"),children:e},e))})]})]}),(0,b.jsx)("main",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c?[...Array(6)].map((e,a)=>(0,b.jsx)("div",{className:"bg-white h-64 rounded-3xl animate-pulse shadow-sm"},a)):w.length>0?(0,b.jsx)(d.N,{children:w.map(e=>(e.status,(0,b.jsxs)(n.P.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-3xl shadow-sm border border-gray-100 overflow-hidden flex flex-col hover:shadow-md transition-shadow",children:[(0,b.jsxs)("div",{className:"p-5 border-b border-gray-50 flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsxs)("span",{className:"text-xs font-black text-gray-300 font-mono",children:["#",e.id.slice(0,8).toUpperCase()]}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest ${f[e.status]?.color}`,children:e.status})]}),(0,b.jsx)("h3",{className:"font-black text-[#3E2723] text-lg",children:e.users?.name||"Anonymous"}),(0,b.jsx)("p",{className:"text-xs text-gray-400 font-medium",children:new Date(e.created_at).toLocaleTimeString()})]}),(0,b.jsx)("div",{className:"p-3 rounded-2xl "+("delivery"===e.order_mode?"bg-orange-50 text-orange-500":"bg-blue-50 text-blue-500"),children:"delivery"===e.order_mode?(0,b.jsx)(y.A,{size:24}):(0,b.jsx)(u.A,{size:24})})]}),(0,b.jsxs)("div",{className:"p-5 flex-1 space-y-4",children:[(0,b.jsx)("div",{className:"space-y-2",children:e.order_items?.map((e,a)=>(0,b.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,b.jsxs)("span",{className:"font-bold text-[#3E2723]",children:[(0,b.jsxs)("span",{className:"text-[#D4AF37]",children:[e.quantity,"x"]})," ",e.name]}),(0,b.jsx)("span",{className:"text-xs text-gray-400 font-medium",children:e.variant})]},a))}),"delivery"===e.order_mode&&(0,b.jsxs)("div",{className:"bg-gray-50 p-3 rounded-2xl border border-gray-100",children:[(0,b.jsx)("p",{className:"text-[10px] font-black text-gray-400 uppercase mb-1",children:"Delivery Address"}),(0,b.jsxs)("p",{className:"text-xs font-bold text-[#3E2723]",children:[e.hostel_block,", Room ",e.room_number]})]})]}),(0,b.jsxs)("div",{className:"p-4 bg-gray-50 flex gap-2",children:["preparing"===e.status&&(0,b.jsxs)("button",{onClick:()=>j(e.id,"ready"),className:"flex-1 bg-purple-600 text-white py-3 rounded-xl text-xs font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-purple-700 transition-all shadow-md active:scale-95",children:["Mark Ready ",(0,b.jsx)(x.A,{size:16})]}),"ready"===e.status&&(0,b.jsxs)("button",{onClick:()=>j(e.id,"delivered"),className:"flex-1 bg-green-600 text-white py-3 rounded-xl text-xs font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-green-700 transition-all shadow-md active:scale-95",children:["Complete ",(0,b.jsx)(m.A,{size:16})]})]})]},e.id)))}):(0,b.jsxs)("div",{className:"col-span-full py-20 bg-white rounded-[40px] border-2 border-dashed border-gray-100 text-center",children:[(0,b.jsx)(u.A,{size:48,className:"text-gray-100 mx-auto mb-4"}),(0,b.jsx)("h2",{className:"text-2xl font-black text-[#3E2723]",children:"No orders found"}),(0,b.jsx)("p",{className:"text-gray-400 font-medium",children:"It's a bit too quiet here... did the internet die?"})]})})]})}},6644(e,a,r){r.d(a,{A:()=>t});const t=(0,r(4207).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},165(e,a,r){r.d(a,{A:()=>t});const t=(0,r(4207).A)("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},7133(e,a,r){r.d(a,{A:()=>t});const t=(0,r(4207).A)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},8110(e,a,r){r.d(a,{A:()=>t});const t=(0,r(4207).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])}}]);
//# sourceMappingURL=592.f819c1b9.js.map