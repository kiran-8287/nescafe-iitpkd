{"version":3,"file":"static/js/198.73fe0e25.js","mappings":"kTAoBA,MAAMA,EAAgB,CAClBC,QAAS,CAAEC,MAAO,8BAA+BC,KAAMC,EAAAA,EAAOC,MAAO,WACrEC,UAAW,CAAEJ,MAAO,4BAA6BC,KAAMI,EAAAA,EAASF,MAAO,aACvEG,MAAO,CAAEN,MAAO,gCAAiCC,KAAMM,EAAAA,EAASJ,MAAO,SACvEK,UAAW,CAAER,MAAO,8BAA+BC,KAAMQ,EAAAA,EAAcN,MAAO,aAC9EO,UAAW,CAAEV,MAAO,0BAA2BC,KAAMU,EAAAA,EAAaR,MAAO,cA+M7E,EA5MuBS,KACnB,MAAM,KAAEC,IAASC,EAAAA,EAAAA,MACVC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,KAC9BC,EAASC,IAAcF,EAAAA,EAAAA,WAAS,IAChCG,EAAcC,IAAmBJ,EAAAA,EAAAA,UAAS,QAEjDK,EAAAA,EAAAA,WAAU,KACNC,IAGA,MAAMC,EAAeC,EAAAA,EAChBC,QAAQ,kBACRC,GAAG,mBAAoB,CAAEC,MAAO,IAAKC,OAAQ,SAAUC,MAAO,UAAY,KACvEP,MAEHQ,YAEL,MAAO,KACHN,EAAAA,EAASO,cAAcR,KAE5B,IAEH,MAAMD,EAAcU,UAChB,IACI,MAAM,KAAEC,EAAI,MAAEC,SAAgBV,EAAAA,EACzBW,KAAK,UACLC,OAAO,iJAKPC,MAAM,aAAc,CAAEC,WAAW,IAEtC,GAAIJ,EAAO,MAAMA,EACjBnB,EAAUkB,EACd,CAAE,MAAOC,GACLK,QAAQL,MAAM,yBAA0BA,GACxCM,EAAAA,GAAMN,MAAM,wBAChB,CAAE,QACEhB,GAAW,EACf,GAGEuB,EAAoBT,MAAOU,EAASC,KACtC,IACI,MAAM,MAAET,SAAgBV,EAAAA,EACnBW,KAAK,UACLS,OAAO,CAAEC,OAAQF,IACjBG,GAAG,KAAMJ,GAEd,GAAIR,EAAO,MAAMA,EACjBM,EAAAA,GAAMO,QAAQ,mBAAmBJ,IACrC,CAAE,MAAOT,GACLK,QAAQL,MAAM,yBAA0BA,GACxCM,EAAAA,GAAMN,MAAM,0BAChB,GA6BEc,EAAkC,QAAjB7B,EACjBL,EACAA,EAAOmC,OAAOC,GAAKA,EAAEL,SAAW1B,GAEtC,OACIgC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+CAA8CC,SAAA,EACzDF,EAAAA,EAAAA,MAAA,UAAQC,UAAU,yFAAwFC,SAAA,EACtGF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACIC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,qCAAoCC,SAAC,4BACnDC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,4BAA2BC,SAAC,gDAG7CF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,0BAAyBC,SAAA,EACpCF,EAAAA,EAAAA,MAAA,UACII,QAxCMvB,UACtB,GAAKwB,OAAOC,QAAQ,6JAEpB,IACIvC,GAAW,GAGX,MAAQgB,MAAOwB,SAAqBlC,EAAAA,EAASW,KAAK,eAAewB,SAASC,IAAI,KAAM,wCACpF,GAAIF,EAAY,MAAMA,EAEtB,MAAQxB,MAAO2B,SAAsBrC,EAAAA,EAASW,KAAK,UAAUwB,SAASC,IAAI,KAAM,wCAChF,GAAIC,EAAa,MAAMA,EAEvB,MAAQ3B,MAAO4B,SAAqBtC,EAAAA,EAASW,KAAK,SAASwB,SAASC,IAAI,KAAM,wCAC9E,GAAIE,EAAY,MAAMA,EAEtBtB,EAAAA,GAAMO,QAAQ,0BACdzB,GACJ,CAAE,MAAOY,GACLK,QAAQL,MAAM,eAAgBA,GAC9BM,EAAAA,GAAMN,MAAM,yBAChB,CAAE,QACEhB,GAAW,EACf,GAkBgBkC,UAAU,wKAAuKC,SAAA,EAEjLC,EAAAA,EAAAA,KAACS,EAAAA,EAAK,CAACC,KAAM,KAAM,oBAEvBV,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iFAAgFC,SAC1F,CAAC,MAAO,YAAa,QAAS,aAAaY,IAAKpB,IAC7CS,EAAAA,EAAAA,KAAA,UAEIC,QAASA,IAAMnC,EAAgByB,GAC/BO,UAAW,sGAAqGjC,IAAiB0B,EAAS,0BAA4B,sCAC/JQ,SAENR,GALIA,aAYzBS,EAAAA,EAAAA,KAAA,QAAMF,UAAU,yEAAwEC,SACnFpC,EACG,IAAIiD,MAAM,IAAID,IAAI,CAACE,EAAGC,KAClBd,EAAAA,EAAAA,KAAA,OAAaF,UAAU,qDAAbgB,IAEdpB,EAAeqB,OAAS,GACxBf,EAAAA,EAAAA,KAACgB,EAAAA,EAAe,CAAAjB,SACXL,EAAeiB,IAAK5B,IACExC,EAAcwC,EAAMQ,SAAS7C,MAAQuE,EAAAA,GAEpDpB,EAAAA,EAAAA,MAACqB,EAAAA,EAAOC,IAAG,CAEPC,QAAM,EACNC,QAAS,CAAEC,QAAS,EAAGC,MAAO,IAC9BC,QAAS,CAAEF,QAAS,EAAGC,MAAO,GAC9BE,KAAM,CAAEH,QAAS,EAAGC,MAAO,IAC3BzB,UAAU,wHAAuHC,SAAA,EAEjIF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+DAA8DC,SAAA,EACzEF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACIF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,+BAA8BC,SAAA,EACzCF,EAAAA,EAAAA,MAAA,QAAMC,UAAU,6CAA4CC,SAAA,CAAC,IAAEhB,EAAM2C,GAAGC,MAAM,EAAG,GAAGC,kBACpF5B,EAAAA,EAAAA,KAAA,QAAMF,UAAW,6EAA6EvD,EAAcwC,EAAMQ,SAAS9C,QAAQsD,SAC9HhB,EAAMQ,aAGfS,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oCAAmCC,SAAEhB,EAAM8C,OAAOC,MAAQ,eACxE9B,EAAAA,EAAAA,KAAA,KAAGF,UAAU,oCAAmCC,SAAE,IAAIgC,KAAKhD,EAAMiD,YAAYC,2BAEjFjC,EAAAA,EAAAA,KAAA,OAAKF,UAAW,oBAAwC,aAArBf,EAAMmD,WAA4B,+BAAiC,4BAA6BnC,SACzG,aAArBhB,EAAMmD,YAA4BlC,EAAAA,EAAAA,KAACmC,EAAAA,EAAI,CAACzB,KAAM,MAASV,EAAAA,EAAAA,KAACoC,EAAAA,EAAW,CAAC1B,KAAM,WAInFb,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBC,SAAA,EACjCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SACrBhB,EAAMsD,aAAa1B,IAAI,CAAC2B,EAAMC,KAC3B1C,EAAAA,EAAAA,MAAA,OAAeC,UAAU,4CAA2CC,SAAA,EAChEF,EAAAA,EAAAA,MAAA,QAAMC,UAAU,2BAA0BC,SAAA,EAACF,EAAAA,EAAAA,MAAA,QAAMC,UAAU,iBAAgBC,SAAA,CAAEuC,EAAKE,SAAS,OAAQ,IAAEF,EAAKR,SAC1G9B,EAAAA,EAAAA,KAAA,QAAMF,UAAU,oCAAmCC,SAAEuC,EAAKG,YAFpDF,MAOI,aAArBxD,EAAMmD,aACHrC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oDAAmDC,SAAA,EAC9DC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,sDAAqDC,SAAC,sBACnEF,EAAAA,EAAAA,MAAA,KAAGC,UAAU,mCAAkCC,SAAA,CAAEhB,EAAM2D,aAAa,UAAQ3D,EAAM4D,sBAK9F9C,EAAAA,EAAAA,MAAA,OAAKC,UAAU,4BAA2BC,SAAA,CACpB,cAAjBhB,EAAMQ,SACHM,EAAAA,EAAAA,MAAA,UACII,QAASA,IAAMd,EAAkBJ,EAAM2C,GAAI,SAC3C5B,UAAU,mMAAkMC,SAAA,CAC/M,eACcC,EAAAA,EAAAA,KAAChD,EAAAA,EAAO,CAAC0D,KAAM,QAGhB,UAAjB3B,EAAMQ,SACHM,EAAAA,EAAAA,MAAA,UACII,QAASA,IAAMd,EAAkBJ,EAAM2C,GAAI,aAC3C5B,UAAU,iMAAgMC,SAAA,CAC7M,aACYC,EAAAA,EAAAA,KAAC9C,EAAAA,EAAY,CAACwD,KAAM,aAvDpC3B,EAAM2C,SAgE3B7B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iGAAgGC,SAAA,EAC3GC,EAAAA,EAAAA,KAACoC,EAAAA,EAAW,CAAC1B,KAAM,GAAIZ,UAAU,gCACjCE,EAAAA,EAAAA,KAAA,MAAIF,UAAU,qCAAoCC,SAAC,qBACnDC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,4BAA2BC,SAAC,+D","sources":["webpack://nescafe-restaurant/./src/components/AdminDashboard.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { supabase } from '../supabaseClient';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    ShoppingBag,\r\n    Clock,\r\n    CheckCircle2,\r\n    AlertCircle,\r\n    Bike,\r\n    Package,\r\n    Search,\r\n    RefreshCcw,\r\n    ChefHat,\r\n    ChevronRight,\r\n    CircleDashed,\r\n    Trash\r\n} from 'lucide-react';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst STATUS_CONFIG = {\r\n    pending: { color: 'bg-amber-100 text-amber-700', icon: Clock, label: 'Pending' },\r\n    preparing: { color: 'bg-blue-100 text-blue-700', icon: ChefHat, label: 'Preparing' },\r\n    ready: { color: 'bg-purple-100 text-purple-700', icon: Package, label: 'Ready' },\r\n    delivered: { color: 'bg-green-100 text-green-700', icon: CheckCircle2, label: 'Delivered' },\r\n    cancelled: { color: 'bg-red-100 text-red-700', icon: AlertCircle, label: 'Cancelled' }\r\n};\r\n\r\nconst AdminDashboard = () => {\r\n    const { user } = useAuth();\r\n    const [orders, setOrders] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filterStatus, setFilterStatus] = useState('all');\r\n\r\n    useEffect(() => {\r\n        fetchOrders();\r\n\r\n        // Real-time subscription\r\n        const subscription = supabase\r\n            .channel('orders-channel')\r\n            .on('postgres_changes', { event: '*', schema: 'public', table: 'orders' }, () => {\r\n                fetchOrders();\r\n            })\r\n            .subscribe();\r\n\r\n        return () => {\r\n            supabase.removeChannel(subscription);\r\n        };\r\n    }, []);\r\n\r\n    const fetchOrders = async () => {\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('orders')\r\n                .select(`\r\n                    *,\r\n                    users!orders_user_id_fkey (name, email),\r\n                    order_items (*)\r\n                `)\r\n                .order('created_at', { ascending: false });\r\n\r\n            if (error) throw error;\r\n            setOrders(data);\r\n        } catch (error) {\r\n            console.error('Error fetching orders:', error);\r\n            toast.error('Failed to load orders');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const updateOrderStatus = async (orderId, newStatus) => {\r\n        try {\r\n            const { error } = await supabase\r\n                .from('orders')\r\n                .update({ status: newStatus })\r\n                .eq('id', orderId);\r\n\r\n            if (error) throw error;\r\n            toast.success(`Order marked as ${newStatus}`);\r\n        } catch (error) {\r\n            console.error('Error updating status:', error);\r\n            toast.error('Failed to update status');\r\n        }\r\n    };\r\n\r\n    const handleSystemReset = async () => {\r\n        if (!window.confirm(\"⚠️ DANGER: This will delete ALL user profiles, ALL orders, and ALL order items. You must still manually delete users from the Supabase Auth tab. Proceed?\")) return;\r\n\r\n        try {\r\n            setLoading(true);\r\n\r\n            // Delete in correct order to satisfy foreign keys\r\n            const { error: itemsError } = await supabase.from('order_items').delete().neq('id', '00000000-0000-4000-a000-000000000000');\r\n            if (itemsError) throw itemsError;\r\n\r\n            const { error: ordersError } = await supabase.from('orders').delete().neq('id', '00000000-0000-4000-a000-000000000000');\r\n            if (ordersError) throw ordersError;\r\n\r\n            const { error: usersError } = await supabase.from('users').delete().neq('id', '00000000-0000-4000-a000-000000000000');\r\n            if (usersError) throw usersError;\r\n\r\n            toast.success('System Reset Complete!');\r\n            fetchOrders();\r\n        } catch (error) {\r\n            console.error('Reset error:', error);\r\n            toast.error('Failed to reset system');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const filteredOrders = filterStatus === 'all'\r\n        ? orders\r\n        : orders.filter(o => o.status === filterStatus);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50 p-4 md:p-8 font-sans\">\r\n            <header className=\"max-w-6xl mx-auto mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-black text-[#3E2723]\">Nescafe Command Center</h1>\r\n                    <p className=\"text-gray-500 font-medium\">Manage incoming orders and live status.</p>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                    <button\r\n                        onClick={handleSystemReset}\r\n                        className=\"flex items-center gap-2 bg-red-50 text-red-600 px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wider hover:bg-red-100 transition-all border border-red-100\"\r\n                    >\r\n                        <Trash size={14} /> System Reset\r\n                    </button>\r\n                    <div className=\"flex bg-white p-1 rounded-2xl shadow-sm border border-gray-100 overflow-x-auto\">\r\n                        {['all', 'preparing', 'ready', 'delivered'].map((status) => (\r\n                            <button\r\n                                key={status}\r\n                                onClick={() => setFilterStatus(status)}\r\n                                className={`px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wider transition-all whitespace-nowrap ${filterStatus === status ? 'bg-[#3E2723] text-white' : 'text-gray-400 hover:text-[#3E2723]'\r\n                                    }`}\r\n                            >\r\n                                {status}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                {loading ? (\r\n                    [...Array(6)].map((_, i) => (\r\n                        <div key={i} className=\"bg-white h-64 rounded-3xl animate-pulse shadow-sm\" />\r\n                    ))\r\n                ) : filteredOrders.length > 0 ? (\r\n                    <AnimatePresence>\r\n                        {filteredOrders.map((order) => {\r\n                            const StatusIcon = STATUS_CONFIG[order.status]?.icon || CircleDashed;\r\n                            return (\r\n                                <motion.div\r\n                                    key={order.id}\r\n                                    layout\r\n                                    initial={{ opacity: 0, scale: 0.9 }}\r\n                                    animate={{ opacity: 1, scale: 1 }}\r\n                                    exit={{ opacity: 0, scale: 0.9 }}\r\n                                    className=\"bg-white rounded-3xl shadow-sm border border-gray-100 overflow-hidden flex flex-col hover:shadow-md transition-shadow\"\r\n                                >\r\n                                    <div className=\"p-5 border-b border-gray-50 flex justify-between items-start\">\r\n                                        <div>\r\n                                            <div className=\"flex items-center gap-2 mb-1\">\r\n                                                <span className=\"text-xs font-black text-gray-300 font-mono\">#{order.id.slice(0, 8).toUpperCase()}</span>\r\n                                                <span className={`px-2 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest ${STATUS_CONFIG[order.status]?.color}`}>\r\n                                                    {order.status}\r\n                                                </span>\r\n                                            </div>\r\n                                            <h3 className=\"font-black text-[#3E2723] text-lg\">{order.users?.name || 'Anonymous'}</h3>\r\n                                            <p className=\"text-xs text-gray-400 font-medium\">{new Date(order.created_at).toLocaleTimeString()}</p>\r\n                                        </div>\r\n                                        <div className={`p-3 rounded-2xl ${order.order_mode === 'delivery' ? 'bg-orange-50 text-orange-500' : 'bg-blue-50 text-blue-500'}`}>\r\n                                            {order.order_mode === 'delivery' ? <Bike size={24} /> : <ShoppingBag size={24} />}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"p-5 flex-1 space-y-4\">\r\n                                        <div className=\"space-y-2\">\r\n                                            {order.order_items?.map((item, idx) => (\r\n                                                <div key={idx} className=\"flex justify-between items-center text-sm\">\r\n                                                    <span className=\"font-bold text-[#3E2723]\"><span className=\"text-[#D4AF37]\">{item.quantity}x</span> {item.name}</span>\r\n                                                    <span className=\"text-xs text-gray-400 font-medium\">{item.variant}</span>\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n\r\n                                        {order.order_mode === 'delivery' && (\r\n                                            <div className=\"bg-gray-50 p-3 rounded-2xl border border-gray-100\">\r\n                                                <p className=\"text-[10px] font-black text-gray-400 uppercase mb-1\">Delivery Address</p>\r\n                                                <p className=\"text-xs font-bold text-[#3E2723]\">{order.hostel_block}, Room {order.room_number}</p>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    <div className=\"p-4 bg-gray-50 flex gap-2\">\r\n                                        {order.status === 'preparing' && (\r\n                                            <button\r\n                                                onClick={() => updateOrderStatus(order.id, 'ready')}\r\n                                                className=\"flex-1 bg-purple-600 text-white py-3 rounded-xl text-xs font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-purple-700 transition-all shadow-md active:scale-95\"\r\n                                            >\r\n                                                Mark Ready <Package size={16} />\r\n                                            </button>\r\n                                        )}\r\n                                        {order.status === 'ready' && (\r\n                                            <button\r\n                                                onClick={() => updateOrderStatus(order.id, 'delivered')}\r\n                                                className=\"flex-1 bg-green-600 text-white py-3 rounded-xl text-xs font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-green-700 transition-all shadow-md active:scale-95\"\r\n                                            >\r\n                                                Complete <CheckCircle2 size={16} />\r\n                                            </button>\r\n                                        )}\r\n                                    </div>\r\n                                </motion.div>\r\n                            );\r\n                        })}\r\n                    </AnimatePresence>\r\n                ) : (\r\n                    <div className=\"col-span-full py-20 bg-white rounded-[40px] border-2 border-dashed border-gray-100 text-center\">\r\n                        <ShoppingBag size={48} className=\"text-gray-100 mx-auto mb-4\" />\r\n                        <h2 className=\"text-2xl font-black text-[#3E2723]\">No orders found</h2>\r\n                        <p className=\"text-gray-400 font-medium\">It's a bit too quiet here... did the internet die?</p>\r\n                    </div>\r\n                )}\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdminDashboard;\r\n"],"names":["STATUS_CONFIG","pending","color","icon","Clock","label","preparing","ChefHat","ready","Package","delivered","CheckCircle2","cancelled","AlertCircle","AdminDashboard","user","useAuth","orders","setOrders","useState","loading","setLoading","filterStatus","setFilterStatus","useEffect","fetchOrders","subscription","supabase","channel","on","event","schema","table","subscribe","removeChannel","async","data","error","from","select","order","ascending","console","toast","updateOrderStatus","orderId","newStatus","update","status","eq","success","filteredOrders","filter","o","_jsxs","className","children","_jsx","onClick","window","confirm","itemsError","delete","neq","ordersError","usersError","Trash","size","map","Array","_","i","length","AnimatePresence","CircleDashed","motion","div","layout","initial","opacity","scale","animate","exit","id","slice","toUpperCase","users","name","Date","created_at","toLocaleTimeString","order_mode","Bike","ShoppingBag","order_items","item","idx","quantity","variant","hostel_block","room_number"],"sourceRoot":""}