{"version":3,"file":"static/js/782.96d17a11.js","mappings":"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","sources":["webpack://nescafe-restaurant/./src/components/SignInPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { supabase } from '../supabaseClient';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { Coffee, Mail, Lock, Loader2 } from 'lucide-react';\r\n\r\nconst SignInPage = () => {\r\n    const navigate = useNavigate();\r\n    const { user } = useAuth();\r\n    const [form, setForm] = useState({ email: '', password: '' });\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [showReturningUser, setShowReturningUser] = useState(false);\r\n    const [metadata, setMetadata] = useState(null);\r\n    const [resending, setResending] = useState(false);\r\n\r\n    const handleResend = async () => {\r\n        if (!form.email) {\r\n            toast.error('Enter your email first');\r\n            return;\r\n        }\r\n        setResending(true);\r\n        const { error: resendError } = await supabase.auth.resend({\r\n            type: 'signup',\r\n            email: form.email,\r\n        });\r\n        setResending(false);\r\n        if (resendError) {\r\n            toast.error(resendError.message);\r\n        } else {\r\n            toast.success('Confirmation link sent!');\r\n        }\r\n    };\r\n\r\n    // If already logged in and confirmed, redirect to dashboard\r\n    useEffect(() => {\r\n        const isConfirmed = user?.email_confirmed_at || user?.last_sign_in_at;\r\n        if (user && isConfirmed) {\r\n            navigate('/', { replace: true });\r\n        }\r\n    }, [user, navigate]);\r\n\r\n    // Check for returning user data\r\n    useEffect(() => {\r\n        const stored = localStorage.getItem('nescafe_user_metadata');\r\n        if (stored) {\r\n            try {\r\n                const data = JSON.parse(stored);\r\n                const SEVEN_DAYS = 7 * 24 * 60 * 60 * 1000;\r\n                const isFresh = Date.now() - data.lastLogin < SEVEN_DAYS;\r\n\r\n                setMetadata(data);\r\n                setForm(prev => ({ ...prev, email: data.email }));\r\n\r\n                if (isFresh) {\r\n                    setShowReturningUser(true);\r\n                }\r\n            } catch (e) {\r\n                console.error('Error parsing metadata', e);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    const handleChange = (e) => setForm(prev => ({ ...prev, [e.target.name]: e.target.value }));\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        const { error: signInError } = await supabase.auth.signInWithPassword({\r\n            email: form.email,\r\n            password: form.password,\r\n        });\r\n\r\n        setLoading(false);\r\n\r\n        if (signInError) {\r\n            if (signInError.message.includes('Email not confirmed')) {\r\n                setError('Please check your inbox and confirm your email first.');\r\n            } else if (signInError.message.includes('Invalid login credentials')) {\r\n                setError('Wrong email or password. Try again.');\r\n            } else {\r\n                setError(signInError.message);\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#FFF8E1] flex items-center justify-center p-4\">\r\n            <div className=\"w-full max-w-sm\">\r\n                {/* Header */}\r\n                <div className=\"text-center mb-8\">\r\n                    <div className=\"inline-flex items-center justify-center w-16 h-16 bg-[#3E2723] rounded-2xl mb-4 shadow-lg\">\r\n                        <Coffee size={32} className=\"text-[#D4AF37]\" />\r\n                    </div>\r\n                    <h1 className=\"text-3xl font-black text-[#3E2723]\">\r\n                        {showReturningUser ? `Hi, ${metadata?.name}` : 'Welcome Back'}\r\n                    </h1>\r\n                    <p className=\"text-gray-500 text-sm mt-1\">\r\n                        {showReturningUser ? 'Sign in to continue your session' : 'Sign in to your Nescafe IITPKD account'}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Card */}\r\n                <div className=\"bg-white rounded-3xl shadow-xl p-7 space-y-5 transition-all duration-500\">\r\n                    {error && (\r\n                        <div className=\"bg-red-50 border border-red-100 text-red-600 text-sm font-medium p-4 rounded-xl space-y-3\">\r\n                            <p>{error}</p>\r\n                            {error.includes('confirm your email first') && (\r\n                                <button\r\n                                    onClick={handleResend}\r\n                                    disabled={resending}\r\n                                    className=\"w-full bg-white text-red-600 border border-red-200 py-2 rounded-lg text-xs font-bold hover:bg-red-50 transition-all flex items-center justify-center gap-2 active:scale-95 disabled:opacity-50\"\r\n                                >\r\n                                    {resending ? <Loader2 size={14} className=\"animate-spin\" /> : <Mail size={14} />}\r\n                                    {resending ? 'Resending...' : 'Resend Confirmation Email'}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n\r\n                    {showReturningUser ? (\r\n                        /* Returning User Summary */\r\n                        <div className=\"space-y-6\">\r\n                            <div className=\"flex items-center gap-4 p-4 bg-gray-50 rounded-2xl border-2 border-gray-100\">\r\n                                <div className=\"w-12 h-12 bg-[#3E2723] rounded-full flex items-center justify-center text-[#D4AF37] font-black text-lg\">\r\n                                    {metadata?.name?.charAt(0)}\r\n                                </div>\r\n                                <div className=\"flex-1 min-w-0\">\r\n                                    <h3 className=\"text-sm font-black text-[#3E2723] truncate\">{metadata?.name}</h3>\r\n                                    <p className=\"text-xs text-gray-400 truncate\">{metadata?.email}</p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={() => setShowReturningUser(false)}\r\n                                className=\"w-full bg-[#3E2723] text-white py-4 rounded-2xl font-black text-base hover:bg-[#5D4037] transition-all flex items-center justify-center gap-2 shadow-lg active:scale-90\"\r\n                            >\r\n                                Sign In ☕\r\n                            </button>\r\n\r\n                            <button\r\n                                onClick={() => {\r\n                                    localStorage.removeItem('nescafe_user_metadata');\r\n                                    localStorage.removeItem('sb-udzrvxwjakgwfbnatnbt-auth-token');\r\n                                    setMetadata(null);\r\n                                    setForm({ email: '', password: '' });\r\n                                    setShowReturningUser(false);\r\n                                }}\r\n                                className=\"w-full text-xs font-bold text-gray-400 hover:text-[#3E2723] transition-colors\"\r\n                            >\r\n                                Not you? Switch Account\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        /* Standard Sign In Form */\r\n                        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                            {/* Email */}\r\n                            <div>\r\n                                <label className=\"text-xs font-black text-gray-400 uppercase tracking-wider block mb-1.5\">Email</label>\r\n                                <div className=\"relative\">\r\n                                    <Mail size={16} className=\"absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-300\" />\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        name=\"email\"\r\n                                        value={form.email}\r\n                                        onChange={handleChange}\r\n                                        required\r\n                                        placeholder=\"you@iitpkd.ac.in\"\r\n                                        className=\"w-full pl-10 pr-4 py-3.5 rounded-2xl border-2 border-gray-100 focus:border-[#D4AF37] outline-none text-sm font-medium transition-all\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Password */}\r\n                            <div>\r\n                                <label className=\"text-xs font-black text-gray-400 uppercase tracking-wider block mb-1.5\">Password</label>\r\n                                <div className=\"relative\">\r\n                                    <Lock size={16} className=\"absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-300\" />\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        name=\"password\"\r\n                                        value={form.password}\r\n                                        onChange={handleChange}\r\n                                        required\r\n                                        autoFocus={!!form.email}\r\n                                        placeholder=\"Your password\"\r\n                                        className=\"w-full pl-10 pr-4 py-3.5 rounded-2xl border-2 border-gray-100 focus:border-[#D4AF37] outline-none text-sm font-medium transition-all\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading}\r\n                                className=\"w-full bg-[#3E2723] text-white py-4 rounded-2xl font-black text-base hover:bg-[#5D4037] transition-all flex items-center justify-center gap-2 shadow-lg active:scale-90 disabled:opacity-60 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {loading ? (\r\n                                    <><Loader2 size={20} className=\"animate-spin\" /> Signing in...</>\r\n                                ) : (\r\n                                    'Sign In ☕'\r\n                                )}\r\n                            </button>\r\n                        </form>\r\n                    )}\r\n\r\n                    <p className=\"text-center text-sm text-gray-400\">\r\n                        Don't have an account?{' '}\r\n                        <Link to=\"/signup\" className=\"font-bold text-[#3E2723] hover:text-[#D4AF37] transition-colors\">\r\n                            Sign Up\r\n                        </Link>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SignInPage;\r\n"],"names":["SignInPage","navigate","useNavigate","user","useAuth","form","setForm","useState","email","password","loading","setLoading","error","setError","showReturningUser","setShowReturningUser","metadata","setMetadata","resending","setResending","useEffect","email_confirmed_at","last_sign_in_at","replace","stored","localStorage","getItem","data","JSON","parse","SEVEN_DAYS","isFresh","Date","now","lastLogin","prev","e","console","handleChange","target","name","value","_jsx","className","children","_jsxs","Coffee","size","includes","onClick","async","toast","resendError","supabase","auth","resend","type","message","success","disabled","Loader2","Mail","charAt","removeItem","onSubmit","preventDefault","signInError","signInWithPassword","onChange","required","placeholder","Lock","autoFocus","_Fragment","Link","to"],"sourceRoot":""}