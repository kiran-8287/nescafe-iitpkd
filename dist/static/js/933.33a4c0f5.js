"use strict";(self.webpackChunknescafe_restaurant=self.webpackChunknescafe_restaurant||[]).push([[933],{6933(e,t,s){s.r(t),s.d(t,{default:()=>k});var a=s(6540),r=s(5570),i=s(6485),l=s(429),n=s(9605),c=s(5164),d=s(892),o=s(6644),x=s(232),m=s(8635),p=s(2307),u=s(165),h=s(5107),g=s(2102),b=s(7235),f=s(7133),y=s(9492),j=s(8110),N=s(888),v=s(4848);const w={pending:{color:"bg-amber-100 text-amber-700",icon:b.A,label:"Pending"},preparing:{color:"bg-blue-100 text-blue-700",icon:f.A,label:"Preparing"},ready:{color:"bg-purple-100 text-purple-700",icon:f.A,label:"Ready"},delivered:{color:"bg-green-100 text-green-700",icon:u.A,label:"Delivered"},cancelled:{color:"bg-red-100 text-red-700",icon:o.A,label:"Cancelled"}},k=()=>{const{user:e}=(0,l.A)(),{addItem:t,toggleCart:s}=(0,n._)(),o=(0,r.Zp)(),[u,f]=(0,a.useState)([]),[k,A]=(0,a.useState)(!0),[E,_]=(0,a.useState)("all"),[z,C]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&D()},[e]);const D=async()=>{try{A(!0);const{data:t,error:s}=await i.N.from("orders").select("\n                    *,\n                    order_items (*)\n                ").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;f(t||[])}catch(e){console.error("Error fetching orders:",e),N.Ay.error("Couldn't fetch your history. Like our internet.")}finally{A(!1)}},P=u.filter(e=>"all"===E||("ongoing"===E?["pending","preparing","ready"].includes(e.status):"completed"!==E||["delivered","cancelled"].includes(e.status)));return k?(0,v.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6",children:[(0,v.jsx)("div",{className:"w-12 h-12 border-4 border-[#3E2723] border-t-transparent rounded-full animate-spin mb-4"}),(0,v.jsx)("p",{className:"text-[#3E2723] font-black uppercase tracking-widest text-xs",children:"Reliving memories..."})]}):(0,v.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20 font-sans",children:[(0,v.jsxs)("div",{className:"bg-white px-6 pt-12 pb-6 shadow-sm sticky top-0 z-30 border-b border-gray-100",children:[(0,v.jsxs)("div",{className:"max-w-2xl mx-auto flex items-center gap-4 mb-6",children:[(0,v.jsx)("button",{onClick:()=>o("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,v.jsx)(x.A,{size:24,className:"text-[#3E2723]"})}),(0,v.jsx)("h1",{className:"text-2xl font-black text-[#3E2723]",children:"Your Brew History"})]}),(0,v.jsx)("div",{className:"max-w-2xl mx-auto flex gap-2 p-1 bg-gray-100 rounded-2xl",children:["all","ongoing","completed"].map(e=>(0,v.jsx)("button",{onClick:()=>_(e),className:"flex-1 py-3 px-4 rounded-xl text-[10px] font-black uppercase tracking-wider transition-all "+(E===e?"bg-white text-[#3E2723] shadow-sm":"text-gray-400 hover:text-gray-600"),children:e},e))})]}),(0,v.jsx)("main",{className:"max-w-2xl mx-auto p-4 mt-4 space-y-4",children:P.length>0?P.map(e=>{const a=z===e.id,r=w[e.status]?.icon||b.A;return(0,v.jsx)(d.P.div,{layout:!0,className:"bg-white rounded-[2rem] shadow-sm border border-gray-100 overflow-hidden",children:(0,v.jsxs)("div",{className:"p-5 flex flex-col gap-4",children:[(0,v.jsxs)("div",{className:"flex justify-between items-start",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("div",{className:`p-3 rounded-2xl ${w[e.status]?.color} bg-opacity-10`,children:(0,v.jsx)(r,{size:20})}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{className:"font-black text-[#3E2723]",children:["Order #",e.id.slice(0,8).toUpperCase()]}),(0,v.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-gray-400 font-bold uppercase tracking-wider",children:[(0,v.jsx)(p.A,{size:12})," ",(i=e.created_at,new Date(i).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}))]})]})]}),(0,v.jsxs)("div",{className:"text-right",children:[(0,v.jsxs)("p",{className:"text-lg font-black text-[#3E2723]",children:["₹",e.total_amount]}),(0,v.jsx)("span",{className:`px-2 py-0.5 rounded-full text-[8px] font-black uppercase tracking-widest ${w[e.status]?.color}`,children:e.status})]})]}),(0,v.jsxs)("div",{className:"flex gap-2",children:[(0,v.jsxs)("button",{onClick:()=>C(a?null:e.id),className:"flex-1 py-3 px-4 bg-gray-50 text-[#3E2723] rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-100 transition-all border border-gray-100",children:[a?"Hide Details":"View Details",a?(0,v.jsx)(g.A,{size:14}):(0,v.jsx)(h.A,{size:14})]}),(0,v.jsxs)("button",{onClick:()=>(e=>{e.order_items&&0!==e.order_items.length&&(e.order_items.forEach(e=>{t({id:e.item_id,name:e.name,price:e.price,selectedVariant:e.variant,customization:e.customization||[],quantity:e.quantity})}),N.Ay.success("Past favorites added to cart!"),s())})(e),className:"py-3 px-6 bg-[#3E2723] text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-[#5D4037] transition-all shadow-md active:scale-95",children:["Reorder ",(0,v.jsx)(y.A,{size:14})]})]}),(0,v.jsx)(c.N,{children:a&&(0,v.jsx)(d.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:(0,v.jsxs)("div",{className:"pt-4 mt-4 border-t border-dashed border-gray-100 space-y-3",children:[e.order_items?.map((e,t)=>(0,v.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsxs)("span",{className:"font-bold text-[#3E2723]",children:[e.quantity,"x ",e.name]}),(0,v.jsx)("span",{className:"text-[10px] text-gray-400 font-medium",children:e.variant})]}),(0,v.jsxs)("span",{className:"font-bold text-gray-500",children:["₹",e.price*e.quantity]})]},t)),(0,v.jsxs)("div",{className:"pt-2 flex justify-between items-center border-t border-gray-50",children:[(0,v.jsx)("span",{className:"text-[10px] font-black text-gray-300 uppercase tracking-widest",children:"Total Bill"}),(0,v.jsxs)("span",{className:"font-black text-[#D4AF37]",children:["₹",e.total_amount]})]})]})})})]})},e.id);var i}):(0,v.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center py-20 bg-white rounded-[3rem] border-2 border-dashed border-gray-100 px-6",children:[(0,v.jsx)("div",{className:"w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,v.jsx)(j.A,{size:40,className:"text-gray-200"})}),(0,v.jsx)("h3",{className:"text-xl font-black text-[#3E2723] mb-2",children:"No history yet?"}),(0,v.jsx)("p",{className:"text-gray-400 text-sm font-medium mb-8",children:"Your coffee stories start here. Go ahead, order your first brew!"}),(0,v.jsxs)("button",{onClick:()=>o("/menu"),className:"bg-[#3E2723] text-white py-4 px-8 rounded-2xl font-black shadow-lg hover:bg-[#5D4037] transition-all flex items-center justify-center gap-2 mx-auto active:scale-95",children:["Explore Menu ",(0,v.jsx)(m.A,{size:20})]})]})})]})}}}]);
//# sourceMappingURL=933.33a4c0f5.js.map